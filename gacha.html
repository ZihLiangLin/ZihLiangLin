<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    <title>老婆的抽獎機
      <link rel="icon" href="favicon.png" type="image/png">
    </title>
    <table border="1">
      <tr>
        <td id="td0">學餐的飯</td>
        <td id="td1">學餐的麵</td>
        <td id="td2">學餐滷味</td>
        <td id="td3">鍋貼</td>
        <td id="td4">麥片</td>
      </tr>
      <tr>
        <td id="td15">16</td>
        <td rowspan="3" colspan="3">
          <input id="start" type="button" value="在抽一次！" />
        </td>
        <td id="td5">牛肉麵</td>
      </tr>
      <tr>
        <td id="td14">15</td>
        <td id="td6"></td>
      </tr>
      <tr>
        <td id="td13">14</td>
        <td id="td7">8</td>
      </tr>
      <tr>
        <td id="td12">13</td>
        <td id="td11">12</td>
        <td id="td10">11</td>
        <td id="td9">10</td>
        <td id="td8">9</td>
      </tr>
    </table>
    <style>
      table {
        margin: 100px auto;
      }

      td {
        width: 100px;
        height: 100px;
        /* background-color: #fff; */
        text-align: center;
      }

      input {
        display: block;
        margin: auto;
        width: 100px;
        height: 100px;
      }
    </style>
  </head>
<!--

                                                     __----~~~~~~~~~~~------___
                                    .  .   ~~//====......          __--~ ~~
                    -.            \_|//     |||\\  ~~~~~~::::... /~
                 ___-==_       _-~o~  \/    |||  \\            _/~~-
         __---~~~.==~||\=_    -_--~/_-~|-   |\\   \\        _/~
     _-~~     .=~    |  \\-_    '-~7  /-   /  ||    \      /
   .~       .~       |   \\ -_    /  /-   /   ||      \   /
  /  ____  /         |     \\ ~-_/  /|- _/   .||       \ /
  |~~    ~~|--~~~~--_ \     ~==-/   | \~--===~~        .\
           '         ~-|      /|    |-~\~~       __--~~
                       |-~~-_/ |    |   ~\_   _-~            /\
                            /  \     \__   \/~                \__
                        _--~ _/ | .-~~____--~-/                  ~~==.
                       ((->/~   '.|||' -_|    ~~-/ ,              . _||
                                  -_     ~\      ~~---l__i__i__i--~~_/
                                  _-~-__   ~)  \--______________--~~
                                //.-~~~-~_--~- |-------~~~~~~~~
                                       //.-~~~--\
                                神獸保佑，程式碼沒Bug!
                                
-->
  <body>
    <script>
      function rand(min, max) {
        var num;
        var mix = max - min;
        num = Math.floor(Math.random() * (mix + 1)) + min;
        return num;
      }
      var tds = new Array();
      var timeclock;
      var num = 0;
      var maxNum = rand(48, 80);
      var count = 0;
      var start = document.getElementById("start");
      var timeGo = 500;
      //這邊是建立所有id陣列
      for (let i = 0; i < 16; i++) {
        tds[i] = document.getElementById(`td${i}`);
      }
      //按鈕功能還有防呆和重置歸零
      function gogoLuck() {
        console.log(num);
        tds[num].style.backgroundColor = "#fff";
        timeGo = 500;
        count = 0;
        num = 0;
        maxNum = rand(48, 80);
        console.log(maxNum);
        init();
        start.removeEventListener("click", gogoLuck, false);
      }

      console.log(maxNum);

      //所有判斷等等功能在這邊
      function gogoBox(e) {
        if (count < 9) {
          timeGo = timeGo - 50;
          //預計跑三次
        } else if (maxNum < 10 && timeGo < 500) {
          timeGo = timeGo + 50;
        }

        if (num == 16) {
          num = 0;
        }
        tds[num].style.backgroundColor = "#fa0";
        console.log(num);
        if (num == 0) {
          tds[15].style.backgroundColor = "#fff";
        } else {
          tds[num - 1].style.backgroundColor = "#fff";
        }

        if (maxNum == 0) {
          tds[num].style.backgroundColor = "#ff1000";
          clearInterval(timeclock);
          start.addEventListener("click", gogoLuck, false);
          return;
        }
        maxNum -= 1;
        num += 1;
        count += 1;
        init();
      }

      //主要觸發用函式
      function init() {
        console.log("init");
        timeclock = setTimeout(gogoBox, timeGo);
      }

      window.addEventListener("load", init, false);
    </script>
  </body>
</html>
